{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% load i18n %}

{% block content %}
<div class="container-fluid mb-3">
  <div class="row">
    <div class="col d-flex justify-content-end"><a class="btn btn-link text-info" href="{% url 'location_list' %}">{{ symbols.back|safe }}&nbsp;{% trans 'back' %}</a></div>
  </div>
</div>

<div class="container-fluid border">
  <div class="row">
    <div class="col-8">
        <h3>{% trans 'offerings'|title %} {% trans 'at' %} {% trans 'location' %} {{ location.title }}</h3>
    </div>
    <div class="col-4 d-md-flex justify-content-end">
        {% if user == request.user %}<a class="btn p-0 text-info" href="{% url 'listing_create' 'push' %}"><i class="fas fa-plus"></i> {% trans 'offer' %}</a>{% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col-12 col-sm-4 col-md-2 order-4 order-sm-1">
      <b>{% trans 'category'|title %}</b>
    </div>
    <div class="col-12 col-sm-8 col-md-5 order-1 order-sm-2">
      <b>{% trans 'title'|title %}</b>
    </div>
    <div class="col-12 col-sm-4 col-md-2 order-2 order-sm-3">
      <b>{% trans 'quantity'|title %}</b>
    </div>
    <div class="col-12 col-sm-8 col-md-3 order-3 order-sm-4 d-flex justify-content-end">
      <b>{% trans 'modified'|title %}</b>
    </div>
  </div>
  {% for listing in location.pushs %}
  <div class="row border-top">
    <div class="col-12 col-sm-4 col-md-2 order-4 order-sm-1">
      {% with category=listing.category %}{% include 'category/inc/link.html' %}{% endwith %}
    </div>
    <div class="col-12 col-sm-8 col-md-5 order-1 order-sm-2">
      {% include 'listing/inc/link.html' %} {{ listing.title }}
    </div>
    <div class="col-12 col-sm-4 col-md-2 order-2 order-sm-3">
      {{ listing.quantity }}{{ listing.unit.short }}
    </div>
    <div class="col-12 col-sm-8 col-md-3 order-3 order-sm-4 d-flex justify-content-end" title="{{ listing.modified }}">
      {{ listing.modified|naturaltime }}
    </div>
  </div>
  {% endfor %}
</div>
<hr class="my-5">
<div class="container-fluid border">
  <div class="row">
    <div class="col-8">
      <h3 class="row">{% trans 'requests'|title %} {% trans 'at' %} {% trans 'location' %} {{ location.title }}</h3>
    </div>
    <div class="col-4 d-md-flex justify-content-end">
        {% if user == request.user %}<a class="btn p-0 text-info" href="{% url 'listing_create' 'pull' %}"><i class="fas fa-plus"></i> {% trans 'seek' %}</a>{% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col-12 col-sm-4 col-md-2 order-4 order-sm-1">
      <b>{% trans 'category'|title %}</b>
    </div>
    <div class="col-12 col-sm-8 col-md-5 order-1 order-sm-2">
      <b>{% trans 'title'|title %}</b>
    </div>
    <div class="col-12 col-sm-4 col-md-2 order-2 order-sm-3">
      <b>{% trans 'quantity'|title %}</b>
    </div>
    <div class="col-12 col-sm-8 col-md-3 order-3 order-sm-4 d-md-flex justify-content-end">
      <b>{% trans 'modified'|title %}</b>
    </div>
  </div>
  {% for listing in user.pulls %}
  <div class="row border-top">
    <div class="col-12 col-sm-4 col-md-2 order-4 order-sm-1">
      {% with category=listing.category %}{% include 'category/inc/link.html' %}{% endwith %}
    </div>
    <div class="col-12 col-sm-8 col-md-5 order-1 order-sm-2">
      {% include 'listing/inc/link.html' %} {{ listing.title }}
    </div>
    <div class="col-12 col-sm-4 col-md-2 order-2 order-sm-3">
      {{ listing.quantity }}{{ listing.unit.short }}
    </div>
    <div class="col-12 col-sm-8 col-md-3 order-3 order-sm-4 d-md-flex justify-content-end" title="{{ listing.modified }}">
      {{ listing.modified|naturaltime }}
    </div>
  </div>
  {% endfor %}
</div>

<hr class="my-5">
<div class="container-fluid border">
  <div class="row">
    <div class="col-8">
        <h3>{% trans 'deals'|title %} {% trans 'at' %} {% trans 'location' %} {{ location.title }}</h3>
    </div>
    <div class="col-4 d-md-flex justify-content-end">
      {% if request.user == location.user %}
        <a class="btn p-0 text-info" href="{% url 'deal_create' %}"><i class="fas fa-plus"></i> {% trans 'deal' %}</a>
      {% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col"><b>{% trans 'user'|title %}</b></div>
    <div class="col"><b>{% trans 'offers' %}</b></div>
    <div class="col"><b>{% trans 'takes' %}</b></div>
    <div class="col"><b>{% trans 'partner'|title %}</b></div>
    <div class="col"><b>{% trans 'status' %}</b></div>
    <div class="col"></div>
  </div>
  {% for deal in location.deals %}
  <div class="row border-top">
    <div class="col">{% with user=deal.user %}{% include 'user/inc/link.html' %}{% endwith %}</div>
    <div class="col">{% for listing in deal.pushs %}{% include 'listing/inc/link.html' %} {% endfor %}</div>
    <div class="col">{% for listing in deal.pulls %}{% include 'listing/inc/link.html' %} {% endfor %}</div>
    <div class="col">{% with user=deal.partner %}{% include 'user/inc/link.html' %}{% endwith %}</div>
    <div class="col d-flex justify-content-end">{% include 'deal/inc/status.html' %}</div>
    <div class="col d-flex justify-content-end"><a class="text-info btn" href="{% url 'deal_detail' deal.pk %}"><i class="fas fa-search"></i></a></div>
  </div>
  {% endfor %}
</div>


<hr class="my-5">


<div class="container-fluid border">
  <div class="row">
    <div class="col-8">
        <h3>{% trans 'guilds'|title %} {% trans 'at' %} {% trans 'location' %} {{ location.title }}</h3>
    </div>
    <div class="col-4 d-md-flex justify-content-end">
        <a class="btn btn-link p-0 text-info" href="{% url 'guild_create' %}"><i class="fas fa-plus"></i> {% trans 'guild' %}</a>
    </div>
  </div>
  <div class="row">
    <div class="col"><b>{% trans 'name'|title %}</b></div>
    <div class="col"><b>{% trans 'member'|title %}</b></div>
    <div class="col"><b></b></div>
  </div>
  {% for guild in location.guilds %}
    <div class="row border-top">
      <div class="col">{% include 'guild/inc/link.html' %}</div>
      <div class="col">{% for user in guild.users.all %}{% include 'user/inc/link.html' %}{% endfor %}</div>
      <div class="col d-flex justify-content-end">
        {% if request.user in guild.users.all %}
        <a class="btn btn-link" href="{% url 'guild_delete' guild.pk %}" title="{% trans 'delete' %}">{{ symbols.delete|safe }}</a>
        <a class="btn btn-link" href="{% url 'guild_update' guild.pk %}" title="{% trans 'update' %}">{{ symbols.update|safe }}</a>
        {% endif %}
        <a class="btn btn-link" href="{% url 'guild_detail' guild.pk %}" title="{% trans 'details' %}">{{ symbols.detail|safe }}</a>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
